lines(Pitching_Ohtani_FF$game_date, Pitching_Ohtani_FF$pfx_z, type = 'l', lty = 1, lwd = 2, col = 'gold1')
lines(Pitching_Ohtani_FS$game_date, Pitching_Ohtani_FS$pfx_z, type = 'l', lty = 1, lwd = 2, col = 'green3')
lines(Pitching_Ohtani_SL$game_date, Pitching_Ohtani_SL$pfx_z, type = 'l', lty = 1, lwd = 2, col = 'dodgerblue2')
legend('topleft', c('Curve', 'Cutter', 'Fast', 'Split-finger', 'Slider'), col = c('firebrick1', 'deeppink1', 'gold1', 'green3', 'dodgerblue2'), lwd = 2, lty = 1)
par(mfrow = c(1,1))
##* Plotting scatter plot of Ohtani's plate_x V.S. date
plot(Pitching_Ohtani_CU$game_date, Pitching_Ohtani_CU$plate_x, type = 'l', lty = 1, lwd = 2, col = 'firebrick1', ylim = c(-4,6), xlab = 'Year', ylab = 'plate_x(in feet)', main = "Shohei Ohtani's pitching plate_x \nby date", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
lines(Pitching_Ohtani_FC$game_date, Pitching_Ohtani_FC$plate_x, type = 'l', lty = 1, lwd = 2, col = 'deeppink1')
lines(Pitching_Ohtani_FF$game_date, Pitching_Ohtani_FF$plate_x, type = 'l', lty = 1, lwd = 2, col = 'gold1')
lines(Pitching_Ohtani_FS$game_date, Pitching_Ohtani_FS$plate_x, type = 'l', lty = 1, lwd = 2, col = 'green3')
lines(Pitching_Ohtani_SL$game_date, Pitching_Ohtani_SL$plate_x, type = 'l', lty = 1, lwd = 2, col = 'dodgerblue2')
legend('topleft', c('Curve', 'Cutter', 'Fast', 'Split-finger', 'Slider'), col = c('firebrick1', 'deeppink1', 'gold1', 'green3', 'dodgerblue2'), lwd = 2, lty = 1)
par(mfrow = c(1,1))
##* Plotting scatter plot of Ohtani's plate_z V.S. date
plot(Pitching_Ohtani_CU$game_date, Pitching_Ohtani_CU$plate_z, type = 'l', lty = 1, lwd = 2, col = 'firebrick1', ylim = c(-3,10), xlab = 'Year', ylab = 'plate_z(in feet)', main = "Shohei Ohtani's pitching plate_z \nby date", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
lines(Pitching_Ohtani_FC$game_date, Pitching_Ohtani_FC$plate_z, type = 'l', lty = 1, lwd = 2, col = 'deeppink1')
lines(Pitching_Ohtani_FF$game_date, Pitching_Ohtani_FF$plate_z, type = 'l', lty = 1, lwd = 2, col = 'gold1')
lines(Pitching_Ohtani_FS$game_date, Pitching_Ohtani_FS$plate_z, type = 'l', lty = 1, lwd = 2, col = 'green3')
lines(Pitching_Ohtani_SL$game_date, Pitching_Ohtani_SL$plate_z, type = 'l', lty = 1, lwd = 2, col = 'dodgerblue2')
legend('topleft', c('Curve', 'Cutter', 'Fast', 'Split-finger', 'Slider'), col = c('firebrick1', 'deeppink1', 'gold1', 'green3', 'dodgerblue2'), lwd = 2, lty = 1)
par(mfrow = c(1,1))
##* Plotting scatter plot of Ohtani's vx0 V.S. date
plot(Pitching_Ohtani_CU$game_date, Pitching_Ohtani_CU$vx0, type = 'b', lty = 1, lwd = 1, col = 'firebrick1', ylim = c(-5,20), xlab = 'Year', ylab = 'vx0(in feet)', main = "Shohei Ohtani's pitching vx0 \nby date", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
lines(Pitching_Ohtani_FC$game_date, Pitching_Ohtani_FC$vx0, type = 'b', lty = 1, lwd = 1, col = 'deeppink1')
lines(Pitching_Ohtani_FF$game_date, Pitching_Ohtani_FF$vx0, type = 'b', lty = 1, lwd = 1, col = 'gold1')
lines(Pitching_Ohtani_FS$game_date, Pitching_Ohtani_FS$vx0, type = 'b', lty = 1, lwd = 1, col = 'green3')
lines(Pitching_Ohtani_SL$game_date, Pitching_Ohtani_SL$vx0, type = 'b', lty = 1, lwd = 1, col = 'dodgerblue2')
legend('topleft', c('Curve', 'Cutter', 'Fast', 'Split-finger', 'Slider'), col = c('firebrick1', 'deeppink1', 'gold1', 'green3', 'dodgerblue2'), lwd = 2, lty = 1)
par(mfrow = c(1,1))
##* Plotting scatter plot of Ohtani's vy0 V.S. date
plot(Pitching_Ohtani_CU$game_date, Pitching_Ohtani_CU$vy0, type = 'b', lty = 1, lwd = 1, col = 'firebrick1', ylim = c(-150,-70), xlab = 'Year', ylab = 'vy0(in feet)', main = "Shohei Ohtani's pitching vy0 \nby date", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
lines(Pitching_Ohtani_FC$game_date, Pitching_Ohtani_FC$vy0, type = 'b', lty = 1, lwd = 1, col = 'deeppink1')
lines(Pitching_Ohtani_FF$game_date, Pitching_Ohtani_FF$vy0, type = 'b', lty = 1, lwd = 1, col = 'gold1')
lines(Pitching_Ohtani_FS$game_date, Pitching_Ohtani_FS$vy0, type = 'b', lty = 1, lwd = 1, col = 'green3')
lines(Pitching_Ohtani_SL$game_date, Pitching_Ohtani_SL$vy0, type = 'b', lty = 1, lwd = 1, col = 'dodgerblue2')
legend('topright', c('Curve', 'Cutter', 'Fast', 'Split-finger', 'Slider'), col = c('firebrick1', 'deeppink1', 'gold1', 'green3', 'dodgerblue2'), lwd = 2, lty = 1)
par(mfrow = c(1,1))
##* Plotting scatter plot of Ohtani's vz0 V.S. date
plot(Pitching_Ohtani_CU$game_date, Pitching_Ohtani_CU$vz0, type = 'b', lty = 1, lwd = 1, col = 'firebrick1', ylim = c(-15,20), xlab = 'Year', ylab = 'vz0(in feet)', main = "Shohei Ohtani's pitching vz0 \nby date", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
lines(Pitching_Ohtani_FC$game_date, Pitching_Ohtani_FC$vz0, type = 'b', lty = 1, lwd = 1, col = 'deeppink1')
lines(Pitching_Ohtani_FF$game_date, Pitching_Ohtani_FF$vz0, type = 'b', lty = 1, lwd = 1, col = 'gold1')
lines(Pitching_Ohtani_FS$game_date, Pitching_Ohtani_FS$vz0, type = 'b', lty = 1, lwd = 1, col = 'green3')
lines(Pitching_Ohtani_SL$game_date, Pitching_Ohtani_SL$vz0, type = 'b', lty = 1, lwd = 1, col = 'dodgerblue2')
legend('topleft', c('Curve', 'Cutter', 'Fast', 'Split-finger', 'Slider'), col = c('firebrick1', 'deeppink1', 'gold1', 'green3', 'dodgerblue2'), lwd = 2, lty = 1)
par(mfrow = c(1,1))
##* Plotting scatter plot of Ohtani's spin_axis V.S. date
plot(Pitching_Ohtani_CU$game_date, Pitching_Ohtani_CU$spin_axis, type = 'b', lty = 1, lwd = 1, col = 'firebrick1', ylim = c(20,450), xlab = 'Year', ylab = 'spin_axis(in feet)', main = "Shohei Ohtani's pitching spin_axis \nby date", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
lines(Pitching_Ohtani_FC$game_date, Pitching_Ohtani_FC$spin_axis, type = 'b', lty = 1, lwd = 1, col = 'deeppink1')
lines(Pitching_Ohtani_FF$game_date, Pitching_Ohtani_FF$spin_axis, type = 'b', lty = 1, lwd = 1, col = 'gold1')
lines(Pitching_Ohtani_FS$game_date, Pitching_Ohtani_FS$spin_axis, type = 'b', lty = 1, lwd = 1, col = 'green3')
lines(Pitching_Ohtani_SL$game_date, Pitching_Ohtani_SL$spin_axis, type = 'b', lty = 1, lwd = 1, col = 'dodgerblue2')
legend('topleft', c('Curve', 'Cutter', 'Fast', 'Split-finger', 'Slider'), col = c('firebrick1', 'deeppink1', 'gold1', 'green3', 'dodgerblue2'), lwd = 2, lty = 1)
##** 2.2 Checking correlation ----
##** Checking some variables if there were several correlations
plot(Pitching_Ohtani[,c(1,3,28,29,45,46,47,57,58,90)])
##** Checking some variables by ggscatmat
ggscatmat(Pitching_Ohtani, column = c(1,3,28,29,45,46,47,57,58,90) )
ggscatmat(Pitching_Ohtani_CU_2, column = c(1,3,28,29,45,46,47,57,58,90) )
##** Using Curve-ball's and Curve-ball+ modified data to check some variables if there were several correlations
plot(Pitching_Ohtani_CU[,c(1,3,28,29,45,46,47,57,58,90)])
plot(Pitching_Ohtani_CU_2[,c(1,3,28,29,45,46,47,57,58,90)])
##** Using Cutter-ball and Cutter-ball + modified data to check some variables if there were several correlations
plot(Pitching_Ohtani_FC[,c(1,3,28,29,45,46,47,57,58,90)])
plot(Pitching_Ohtani_FC_2[,c(1,3,28,29,45,46,47,57,58,90)])
##** Using Fast and Fast + modified data to check some variables if there were several correlations
plot(Pitching_Ohtani_FF[,c(1,3,28,29,45,46,47,57,58,90)])
plot(Pitching_Ohtani_FF_2[,c(1,3,28,29,45,46,47,57,58,90)])
##** Using Split-Finger to check some variables if there were several correlations
plot(Pitching_Ohtani_FS[,c(1,3,28,29,45,46,47,57,58,90)])
##** Using Slider and Slider + modified data to check some variables if there were several correlations
plot(Pitching_Ohtani_SL[,c(1,3,28,29,45,46,47,57,58,90)])
plot(Pitching_Ohtani_SL_2[,c(1,3,28,29,45,46,47,57,58,90)])
##** Checking the spin rate vs speed and pitch_type linear regression model (overall)
Ohtani_pitching_m1 <- lm(release_spin_rate~release_speed+pitch_type, data = Pitching_Ohtani)
summary(Ohtani_pitching_m1)
##** Checking release speed vs spin rate, and pitch_type and plotting a linear regression model
Ohtani_pitching_m2 <- lm(release_speed~release_spin_rate+pitch_type, data = Pitching_Ohtani)
summary(Ohtani_pitching_m2)
##** Checking the release speed vs all key variables, and plotting a linear regression model (overall)
Ohtani_pitching_m3 <- lm(release_speed~ pitch_type + vx0 + vy0 + vz0 + release_spin_rate + release_extension +spin_axis, data = Pitching_Ohtani)
summary(Ohtani_pitching_m3)
step(Ohtani_pitching_m3, direction = "backward")
##** Checking the horizontal movement vs key variables, and plotting a linear regression model (overall)
Ohtani_pitching_m4 <- lm(pfx_x~release_speed + release_spin_rate+pitch_type + release_pos_z + vx0 + vy0 + vz0, data = Pitching_Ohtani)
summary(Ohtani_pitching_m4)
step(Ohtani_pitching_m4, direction = "backward")
##** Checking the vertical movement vs key variables, and plotting a linear regression model (overall)
Ohtani_pitching_m5 <- lm(pfx_z~release_speed + release_spin_rate+pitch_type + release_pos_z + vx0 + vy0 + vz0, data = Pitching_Ohtani)
summary(Ohtani_pitching_m5)
step(Ohtani_pitching_m5, direction = "backward")
##** Checking the spin axis movement vs key variables, and plot a linear regression model (overall)
Ohtani_pitching_m6 <- lm(spin_axis~release_speed + release_spin_rate+pitch_type + release_pos_z + ax + ay + az + pfx_x + pfx_z, data = Pitching_Ohtani)
summary(Ohtani_pitching_m6)
step(Ohtani_pitching_m6, direction = "backward")
library(corrplot)
##*** Checking correlation
##*** Column number = 57(release_spin_rate) , 58(release_extension), 90(spin_axis) can not create correlation number
cor(Pitching_Ohtani[,c(3,5,28,29,45,46,47,57,58,90)])
cor(Pitching_Ohtani[,c(3,5,28,29,45,46,47)])
##*** Checking Curve-ball only found it's ok
##*** Maybe there are some clusters inside the overall data which causes it difficult to predict
cor(Pitching_Ohtani_CU_2[,c(3,5,28,29,45,46,47,57,58,90)])
cor(Pitching_Ohtani_CU_2[,c(3,57,58)])
##*** Plotting correlation graph using Curve-ball table:
corrplot(cor(Pitching_Ohtani_CU_2[,c(3,5,28,29,45,46,47,57,58,90)]))
##*** Plotting correlation graph using Cutter-ball table:
corrplot(cor(Pitching_Ohtani_FC_2[,c(3,5,28,29,45,46,47,57,58,90)]))
##*** Plotting correlation graph using Fastball table: it still can not generate data, maybe there are still different clusters
corrplot(cor(Pitching_Ohtani_FF_2[,c(3,5,28,29,45,46,47,57,58,90)]))
##*** Plotting correlation graph using Split-Finger table: it still can not generate data, maybe there are still different clusters
corrplot(cor(Pitching_Ohtani_FS[,c(3,5,28,29,45,46,47,57,58,90)]))
##*** Plotting correlation graph using Slider table: it still can not generate data, maybe there are still different clusters
corrplot(cor(Pitching_Ohtani_SL_2[,c(3,5,28,29,45,46,47,57,58,90)]))
##*** Removing needless variables
remove(Ohtani_pitching_m1, Ohtani_pitching_m2, Ohtani_pitching_m3, Ohtani_pitching_m4, Ohtani_pitching_m5, Ohtani_pitching_m6)
##** 2.2 Checking correlation ----
##** Checking some variables if there were several correlations
plot(Pitching_Ohtani[,c(1,3,28,29,45,46,47,57,58,90)])
##** Checking some variables by ggscatmat
ggscatmat(Pitching_Ohtani, column = c(1,3,28,29,45,46,47,57,58,90) )
ggscatmat(Pitching_Ohtani_CU_2, column = c(1,3,28,29,45,46,47,57,58,90) )
##** Using Curve-ball's and Curve-ball+ modified data to check some variables if there were several correlations
plot(Pitching_Ohtani_CU[,c(1,3,28,29,45,46,47,57,58,90)])
plot(Pitching_Ohtani_CU_2[,c(1,3,28,29,45,46,47,57,58,90)])
##** Using Cutter-ball and Cutter-ball + modified data to check some variables if there were several correlations
plot(Pitching_Ohtani_FC[,c(1,3,28,29,45,46,47,57,58,90)])
plot(Pitching_Ohtani_FC_2[,c(1,3,28,29,45,46,47,57,58,90)])
##** Using Fast and Fast + modified data to check some variables if there were several correlations
plot(Pitching_Ohtani_FF[,c(1,3,28,29,45,46,47,57,58,90)])
plot(Pitching_Ohtani_FF_2[,c(1,3,28,29,45,46,47,57,58,90)])
##** Using Split-Finger to check some variables if there were several correlations
plot(Pitching_Ohtani_FS[,c(1,3,28,29,45,46,47,57,58,90)])
##** Using Slider and Slider + modified data to check some variables if there were several correlations
plot(Pitching_Ohtani_SL[,c(1,3,28,29,45,46,47,57,58,90)])
plot(Pitching_Ohtani_SL_2[,c(1,3,28,29,45,46,47,57,58,90)])
##** Checking the spin rate vs speed and pitch_type linear regression model (overall)
Ohtani_pitching_m1 <- lm(release_spin_rate~release_speed+pitch_type, data = Pitching_Ohtani)
summary(Ohtani_pitching_m1)
##** Checking release speed vs spin rate, and pitch_type and plotting a linear regression model
Ohtani_pitching_m2 <- lm(release_speed~release_spin_rate+pitch_type, data = Pitching_Ohtani)
summary(Ohtani_pitching_m2)
##** Checking the release speed vs all key variables, and plotting a linear regression model (overall)
Ohtani_pitching_m3 <- lm(release_speed~ pitch_type + vx0 + vy0 + vz0 + release_spin_rate + release_extension +spin_axis, data = Pitching_Ohtani)
summary(Ohtani_pitching_m3)
step(Ohtani_pitching_m3, direction = "backward")
##** Checking the horizontal movement vs key variables, and plotting a linear regression model (overall)
Ohtani_pitching_m4 <- lm(pfx_x~release_speed + release_spin_rate+pitch_type + release_pos_z + vx0 + vy0 + vz0, data = Pitching_Ohtani)
summary(Ohtani_pitching_m4)
step(Ohtani_pitching_m4, direction = "backward")
##** Checking the vertical movement vs key variables, and plotting a linear regression model (overall)
Ohtani_pitching_m5 <- lm(pfx_z~release_speed + release_spin_rate+pitch_type + release_pos_z + vx0 + vy0 + vz0, data = Pitching_Ohtani)
summary(Ohtani_pitching_m5)
step(Ohtani_pitching_m5, direction = "backward")
##** Checking the spin axis movement vs key variables, and plot a linear regression model (overall)
Ohtani_pitching_m6 <- lm(spin_axis~release_speed + release_spin_rate+pitch_type + release_pos_z + ax + ay + az + pfx_x + pfx_z, data = Pitching_Ohtani)
summary(Ohtani_pitching_m6)
step(Ohtani_pitching_m6, direction = "backward")
library(corrplot)
##*** Checking correlation
##*** Column number = 57(release_spin_rate) , 58(release_extension), 90(spin_axis) can not create correlation number
cor(Pitching_Ohtani[,c(3,5,28,29,45,46,47,57,58,90)])
cor(Pitching_Ohtani[,c(3,5,28,29,45,46,47)])
##*** Checking Curve-ball only found it's ok
##*** Maybe there are some clusters inside the overall data which causes it difficult to predict
cor(Pitching_Ohtani_CU_2[,c(3,5,28,29,45,46,47,57,58,90)])
cor(Pitching_Ohtani_CU_2[,c(3,57,58)])
##*** Plotting correlation graph using Curve-ball table:
corrplot(cor(Pitching_Ohtani_CU_2[,c(3,5,28,29,45,46,47,57,58,90)]))
##*** Plotting correlation graph using Cutter-ball table:
corrplot(cor(Pitching_Ohtani_FC_2[,c(3,5,28,29,45,46,47,57,58,90)]))
##*** Plotting correlation graph using Fastball table: it still can not generate data, maybe there are still different clusters
corrplot(cor(Pitching_Ohtani_FF_2[,c(3,5,28,29,45,46,47,57,58,90)]))
##*** Plotting correlation graph using Split-Finger table: it still can not generate data, maybe there are still different clusters
corrplot(cor(Pitching_Ohtani_FS[,c(3,5,28,29,45,46,47,57,58,90)]))
##*** Plotting correlation graph using Slider table: it still can not generate data, maybe there are still different clusters
corrplot(cor(Pitching_Ohtani_SL_2[,c(3,5,28,29,45,46,47,57,58,90)]))
##*** Removing needless variables
remove(Ohtani_pitching_m1, Ohtani_pitching_m2, Ohtani_pitching_m3, Ohtani_pitching_m4, Ohtani_pitching_m5, Ohtani_pitching_m6)
ggscatmat(Pitching_Ohtani, column = c(1,3,28,29,45,46,47,57,58,90) )
library(corrplot)
ggscatmat(Pitching_Ohtani, column = c(1,3,28,29,45,46,47,57,58,90) )
library(GGally)
ggscatmat(Pitching_Ohtani, column = c(1,3,28,29,45,46,47,57,58,90) )
ggscatmat(Pitching_Ohtani_CU_2, column = c(1,3,28,29,45,46,47,57,58,90) )
ggscatmat(Pitching_Ohtani, column = c(1,3,28,29,45,46,47,57,58,90) )
##*** 2.3 Plotting Pie charts ----
##*** Open library "viridis"
library("viridis")
##*** Drawing pie charts
par(mfrow = c(1,2))
pie(pie_table_Ohtani_2021$Freq, label = paste_Ohtani_2021, col = viridis(5), lty =3, radius = 1,
main = "2021 \nOhtani pitching's variance")
pie(pie_table_Ohtani_2022$Freq, label = paste_Ohtani_2022, col = viridis(5), lty =3, radius = 1,
main = "2022 \n")
par(mfrow = c(1,1))
##*** Removing needless variables
remove(paste_Ohtani_2021, paste_Ohtani_2022, prop_Ohtani_2021, prop_Ohtani_2022, pie_table_Ohtani_2021, pie_table_Ohtani_2022)
##**** 2.4 Creating histogram charts ----
##**** Creating a histogram chart of Ohtani's 2021 release speed distribution
hist(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2021' &Pitching_Ohtani$pitch_type == 'CU'], breaks = seq(60, 110, 2),
main = "Ohtani's speed distribution \nby differnt pitching types",
xlab = 'Speed(mph)', ylab = '# (count)', col = rgb(0,0,1,0.25), freq = T, ylim = c(0,350), cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5)
hist(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2021' &Pitching_Ohtani$pitch_type == 'FC'],
breaks = seq(60, 110, 2), col = rgb(1,0,0,0.25), add = T, freq = T, cex.axis= 1.5)
hist(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2021' &Pitching_Ohtani$pitch_type == 'FF'],
breaks = seq(60, 110, 2), col = rgb(0,1,0,0.25), add = T, freq = T, cex.axis= 1.5)
hist(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2021' &Pitching_Ohtani$pitch_type == 'FS'],
breaks = seq(60, 110, 2), col = rgb(0,1,1,0.25), add = T, freq = T, cex.axis= 1.5)
hist(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2021' &Pitching_Ohtani$pitch_type == 'SL'],
breaks = seq(60, 110, 2), col = rgb(1,1,0,0.25), add = T, freq = T, cex.axis= 1.5)
legend(60,300, c('Curve Ball','Cutter Ball', "Fast Ball", "Split-Finger Ball", "Slider"),
col = c(rgb(0,0,1,0.25), rgb(1,0,0,0.25), rgb(0,1,0,0.25), rgb(0,1,1,0.25), rgb(1,1,0,0.25)), lwd = c(rep(10,5)), cex= 1 )
##**** Creating a histogram chart of Ohtani's 2022 speed distribution
hist(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2022' &Pitching_Ohtani$pitch_type == 'CU'], breaks = seq(60, 110, 2),
main = "Ohtani's speed distribution \nby differnt pitching types",
xlab = 'Speed(mph)', ylab = '# (count)', col = rgb(0,0,1,0.25), freq = T, ylim = c(0,350), cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5)
hist(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2022' &Pitching_Ohtani$pitch_type == 'FC'],
breaks = seq(60, 110, 2), col = rgb(1,0,0,0.25), add = T, freq = T, cex.axis= 1.5)
hist(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2022' &Pitching_Ohtani$pitch_type == 'FF'],
breaks = seq(60, 110, 2), col = rgb(0,1,0,0.25), add = T, freq = T, cex.axis= 1.5)
hist(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2022' &Pitching_Ohtani$pitch_type == 'FS'],
breaks = seq(60, 110, 2), col = rgb(0,1,1,0.25), add = T, freq = T, cex.axis= 1.5)
hist(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2022' &Pitching_Ohtani$pitch_type == 'SL'],
breaks = seq(60, 110, 2), col = rgb(1,1,0,0.25), add = T, freq = T, cex.axis= 1.5)
legend(60,300, c('Curve Ball','Cutter Ball', "Fast Ball", "Split-Finger Ball", "Slider"),
col = c(rgb(0,0,1,0.25), rgb(1,0,0,0.25), rgb(0,1,0,0.25), rgb(0,1,1,0.25), rgb(1,1,0,0.25)), lwd = c(rep(10,5)), cex= 1 )
##**** Creating a histogram chart of Ohtani's 2021 speed distribution
hist(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2021'], breaks = seq(60, 110, 2),
main = "Ohtani's speed distribution \nby differnt pitching types",
xlab = 'Speed(mph)', ylab = '# (count)', col = rgb(0,0,1,0.25), freq = T, ylim = c(0,350), cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5)
par(mfrow = c(2,1))
##**** Creating a histogram chart of Ohtani's 2021 speed distribution density
dense_2021_Ohtani_CU <- density(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2021' & Pitching_Ohtani$pitch_type == 'CU'], bw = 2)
plot(dense_2021_Ohtani_CU, main = "2021 Ohtani's speed distribution density \nby differnt pitching types\n",xlab ='Speed(mph)', ylab = 'density', col = 'firebrick1', xlim = c(40,110), ylim = c(0,0.2), lty = 1, lwd = 2, cex.main = 1.5, cex.axis= 1.5, cex.lab= 1.5)
dense_2021_Ohtani_FC <- density(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2021' & Pitching_Ohtani$pitch_type == 'FC'], bw = 2)
lines(dense_2021_Ohtani_FC, col = 'deeppink1', lty = 1, lwd = 2)
dense_2021_Ohtani_FF <- density(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2021' & Pitching_Ohtani$pitch_type == 'FF'], bw = 2)
lines(dense_2021_Ohtani_FF, col = 'gold1', lty = 1, lwd = 2)
dense_2021_Ohtani_FS <- density(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2021' & Pitching_Ohtani$pitch_type == 'FS'], bw = 2)
lines(dense_2021_Ohtani_FS, col = 'green3', lty = 1, lwd = 2)
dense_2021_Ohtani_SL <- density(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2021' & Pitching_Ohtani$pitch_type == 'SL'], bw = 2)
lines(dense_2021_Ohtani_SL, col = 'dodgerblue', lty = 1, lwd = 2)
abline(v=median(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2021' & Pitching_Ohtani$pitch_type == 'CU']), lty=2, lwd=2, col="red")
abline(v=median(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2021' & Pitching_Ohtani$pitch_type == 'FC']), lty=2, lwd=2, col="deeppink1")
abline(v=median(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2021' & Pitching_Ohtani$pitch_type == 'FF']), lty=2, lwd=2, col="goldenrod1")
abline(v=median(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2021' & Pitching_Ohtani$pitch_type == 'FS']), lty=2, lwd=2, col="green")
abline(v=median(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2021' & Pitching_Ohtani$pitch_type == 'SL']), lty=2, lwd=2, col="blue")
legend(40,0.20, c('Curve Ball','Cutter Ball', "Fast Ball"), col = c('firebrick1', 'deeppink1', 'gold1'), lwd = 2, cex= 1 )
##**** Creating a histogram chart of Ohtani's 2022 speed distribution density
dense_2022_Ohtani_CU <- density(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2022' & Pitching_Ohtani$pitch_type == 'CU'], bw = 2)
plot(dense_2022_Ohtani_CU, main = "2022\n\n",xlab =' ', ylab = ' ', col = 'firebrick1', xlim = c(40,110), ylim = c(0,0.2), lty = 1, lwd = 2, cex.main = 1.5, cex.axis= 1.5, cex.lab= 1.5)
dense_2022_Ohtani_FC <- density(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2022' & Pitching_Ohtani$pitch_type == 'FC'], bw = 2)
lines(dense_2022_Ohtani_FC, col = 'deeppink1', lty = 1, lwd = 2)
dense_2022_Ohtani_FF <- density(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2022' & Pitching_Ohtani$pitch_type == 'FF'], bw = 2)
lines(dense_2022_Ohtani_FF, col = 'gold1', lty = 1, lwd = 2)
dense_2022_Ohtani_FS <- density(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2022' & Pitching_Ohtani$pitch_type == 'FS'], bw = 2)
lines(dense_2022_Ohtani_FS, col = 'green3', lty = 1, lwd = 2)
dense_2022_Ohtani_SL <- density(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2022' & Pitching_Ohtani$pitch_type == 'SL'], bw = 2)
lines(dense_2022_Ohtani_SL, col = 'dodgerblue', lty = 1, lwd = 2)
abline(v=median(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2022' & Pitching_Ohtani$pitch_type == 'CU']), lty=2, lwd=2, col="red")
abline(v=median(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2022' & Pitching_Ohtani$pitch_type == 'FC']), lty=2, lwd=2, col="deeppink1")
abline(v=median(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2022' & Pitching_Ohtani$pitch_type == 'FF']), lty=2, lwd=2, col="goldenrod1")
abline(v=median(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2022' & Pitching_Ohtani$pitch_type == 'FS']), lty=2, lwd=2, col="green")
abline(v=median(Pitching_Ohtani$release_speed[Pitching_Ohtani$year == '2022' & Pitching_Ohtani$pitch_type == 'SL']), lty=2, lwd=2, col="blue")
legend(40,0.20, c("Split-Finger Ball", "Slider"), col = c('green3', 'dodgerblue'), lwd = 2, cex= 1 )
arrows(x0 = 75, y0 = 0.15, x1 = 78, y1 = 0.15, length = 0.15, angle = 30, col =  'red', lwd = 2)
arrows(x0 = 87.2, y0 = 0.08, x1 = 90, y1 = 0.08, length = 0.15, angle = 30, col =  'deeppink1', lwd = 2)
arrows(x0 = 95.8, y0 = 0.18, x1 = 97, y1 = 0.18, length = 0.15, angle = 30, col =  'goldenrod1', lwd = 2)
arrows(x0 = 88.3, y0 = 0.18, x1 = 89.9, y1 = 0.18, length = 0.15, angle = 30, col =  'green', lwd = 2)
arrows(x0 = 82.3, y0 = 0.18, x1 = 84.75, y1 = 0.18, length = 0.15, angle = 30, col =  'blue', lwd = 2)
text(75,0.18,labels = "+3.3", adj = 0.5, lwd = 2)
text(87.1,0.11,labels = "+3.2", adj = 0, lwd = 2)
text(95.8,0.19,labels = "+1.2", adj = 1, lwd = 2)
text(88.3,0.19,labels = "+1.6", adj = 1, lwd = 2)
text(82.3,0.19,labels = "+2.45", adj = 1, lwd = 2)
par(mfrow = c(1,1))
##**** Removing needless variables
remove(dense_2021_Ohtani_CU, dense_2021_Ohtani_FC, dense_2021_Ohtani_FF, dense_2021_Ohtani_FS, dense_2021_Ohtani_SL, dense_2022_Ohtani_CU, dense_2022_Ohtani_FC, dense_2022_Ohtani_FF, dense_2022_Ohtani_FS, dense_2022_Ohtani_SL)
### 3.0 Analyzing and plotting (using Ohtani's batting table) (Title only) ----
###* 3.1 box plot ----
###* Drawing a box plot to check the Ohtani's launch speed sorting by the date
par(mfrow = c(1,1))
boxplot(launch_speed~year, data = Batting_Ohtani_100, col = c('yellow'), main = "Shohei Ohtani's batting launch speed \nby year", xlab = 'Year', ylab = 'Launch speed(mph)', cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5)
lines(type = 'b', Batting_Ohtani_100_aggre_ls$launch_speed, lty = 3, lwd = 5, col = 'red', pch = 19)
legend("bottomleft", c("Average launch speed"), lty = 3, lwd = 5, col = c('red'), pch = 19 )
###* Drawing a box plot to check the Ohtani's launch angle sorting by the date
par(mfrow = c(1,1))
boxplot(launch_angle~year, data = Batting_Ohtani_100, col = c('yellow'), main = "Shohei Ohtani's batting launch angle \nby year", xlab = 'Year', ylab = 'Launch angle', cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5)
lines(type = 'b', Batting_Ohtani_100_aggre_la$launch_angle, lty = 3, lwd = 5, col = 'red', pch = 19)
legend("topleft", c("Average launch angle"), lty = 3, lwd = 5, col = c('red'), pch = 19 )
###* Zooming-in to check the launch_angle's mean
par(mfrow = c(1,1))
boxplot(launch_angle~year, data = Batting_Ohtani_100, col = c('yellow'), main = "Shohei Ohtani's batting launch angle \nby year", ylim = c(10, 50), xlab = 'Year', ylab = 'Launch angle', cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5)
lines(type = 'b', Batting_Ohtani_100_aggre_la$launch_angle, lty = 3, lwd = 5, col = 'red', pch = 19)
legend("topleft", c("Average launch speed"), lty = 3, lwd = 5, col = c('red'), pch = 19 )
###* Removing needless variables
remove(Batting_Ohtani_100_aggre_la, Batting_Ohtani_100_aggre_ls)
###** 3.2 Scatter plot ----
###** Drawing a scatter plot the check Ohtani's launch speed by date
par(mfrow = c(1,1))
plot(Batting_Ohtani_100$game_date, Batting_Ohtani_100$launch_speed, type = 'l', lty = 1, lwd = 2, col = 'firebrick1', ylim = c(40,120), xlab = 'Year', ylab = 'Launch speed(mph)', main = "Shohei Ohtani's batting launch speed \nby date", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
legend("bottomleft", c("Average launch speed"), lty = 3, lwd = 5, col = c('red'), pch = 19 )
par(mfrow = c(1,1))
###** Drawing a scatter plot the check Ohtani's launch speed by date
plot(Batting_Ohtani_100$game_date, Batting_Ohtani_100$launch_angle, type = 'l', lty = 1, lwd = 2, col = 'firebrick1', ylim = c(0,80), xlab = 'Year', ylab = 'Launch angle', main = "Shohei Ohtani's batting launch speed \nby date", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
legend("topleft", c("Average launch angle"), lty = 3, lwd = 5, col = c('red'), pch = 19 )
par(mfrow = c(1,1))
###** Plotting by Ohtani's batting launch speed by pitching type by year
plot(type = 'b', Batting_Ohtani_100_ls_year$year[Batting_Ohtani_100_ls_year$pitch_type == 'CH'], Batting_Ohtani_100_ls_year$launch_speed[Batting_Ohtani_100_ls_year$pitch_type == 'CH'], lty = 1, lwd =2, ylim = c(35,112), pch = 19, col = 'red', xlab = "year", ylab = "launch_speed(mph)", main = "Ohtani's batting launch_speed \nin different years", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5)
lines(type = 'b', Batting_Ohtani_100_ls_year$year[Batting_Ohtani_100_ls_year$pitch_type == 'CU'], Batting_Ohtani_100_ls_year$launch_speed[Batting_Ohtani_100_ls_year$pitch_type == 'CU'], lty = 1, lwd =2, pch = 19, col = 'orange')
lines(type = 'b', Batting_Ohtani_100_ls_year$year[Batting_Ohtani_100_ls_year$pitch_type == 'FA'], Batting_Ohtani_100_ls_year$launch_speed[Batting_Ohtani_100_ls_year$pitch_type == 'FA'], lty = 1, lwd =2, pch = 19, col = 'gold1')
lines(type = 'b', Batting_Ohtani_100_ls_year$year[Batting_Ohtani_100_ls_year$pitch_type == 'FC'], Batting_Ohtani_100_ls_year$launch_speed[Batting_Ohtani_100_ls_year$pitch_type == 'FC'], lty = 1, lwd =2, pch = 19, col = 'limegreen')
lines(type = 'b', Batting_Ohtani_100_ls_year$year[Batting_Ohtani_100_ls_year$pitch_type == 'FF'], Batting_Ohtani_100_ls_year$launch_speed[Batting_Ohtani_100_ls_year$pitch_type == 'FF'], lty = 1, lwd =2, pch = 19, col = 'cyan4')
lines(type = 'b', Batting_Ohtani_100_ls_year$year[Batting_Ohtani_100_ls_year$pitch_type == 'FO'], Batting_Ohtani_100_ls_year$launch_speed[Batting_Ohtani_100_ls_year$pitch_type == 'FO'], lty = 1, lwd =2, pch = 19, col = 'darkorchid2')
lines(type = 'b', Batting_Ohtani_100_ls_year$year[Batting_Ohtani_100_ls_year$pitch_type == 'FS'], Batting_Ohtani_100_ls_year$launch_speed[Batting_Ohtani_100_ls_year$pitch_type == 'FS'], lty = 1, lwd =2, pch = 19, col = 'mediumorchid4')
lines(type = 'b', Batting_Ohtani_100_ls_year$year[Batting_Ohtani_100_ls_year$pitch_type == 'KC'], Batting_Ohtani_100_ls_year$launch_speed[Batting_Ohtani_100_ls_year$pitch_type == 'KC'], lty = 1, lwd =2, pch = 19, col = 'olivedrab4')
lines(type = 'b', Batting_Ohtani_100_ls_year$year[Batting_Ohtani_100_ls_year$pitch_type == 'SI'], Batting_Ohtani_100_ls_year$launch_speed[Batting_Ohtani_100_ls_year$pitch_type == 'SI'], lty = 1, lwd =2, pch = 19, col = 'seagreen')
lines(type = 'b', Batting_Ohtani_100_ls_year$year[Batting_Ohtani_100_ls_year$pitch_type == 'SL'], Batting_Ohtani_100_ls_year$launch_speed[Batting_Ohtani_100_ls_year$pitch_type == 'SL'], lty = 1, lwd =2, pch = 19, col = 'tomato')
legend("bottomleft", c("CH (-14.9)", "CU (-9.7)", "FA (NA)", "FC (+7.4)", "FF (-1)", "FO (NA)", "FS (-27.5)", "KC (NA)", "SI (-4.2)", "SL (-5.1)"), col = c("red", "orange", "gold1", "limegreen", "cyan4", "darkorchid", "mediumorchid4", "olivedrab4", "seagreen", "tomato"), lty = 1, lwd =2, text.col = c("blue", "blue", "black", "black", "blue", "black", "blue", "black", "blue", "blue"), pch = 19)
par(mfrow = c(1,1))
###** Plotting by Ohtani's batting launch angle by pitching type by year
plot(type = 'b', Batting_Ohtani_100_la_year$year[Batting_Ohtani_100_la_year$pitch_type == 'CH'], Batting_Ohtani_100_la_year$launch_angle[Batting_Ohtani_100_la_year$pitch_type == 'CH'], lty = 1, lwd =2, ylim = c(-30,60), pch = 19, col = 'red', xlab = "year", ylab = "launch_angle(mph)", main = "Ohtani's batting launch_angle \nin different years", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5)
lines(type = 'b', Batting_Ohtani_100_la_year$year[Batting_Ohtani_100_la_year$pitch_type == 'CU'], Batting_Ohtani_100_la_year$launch_angle[Batting_Ohtani_100_la_year$pitch_type == 'CU'], lty = 1, lwd =2, pch = 19, col = 'orange')
lines(type = 'b', Batting_Ohtani_100_la_year$year[Batting_Ohtani_100_la_year$pitch_type == 'FA'], Batting_Ohtani_100_la_year$launch_angle[Batting_Ohtani_100_la_year$pitch_type == 'FA'], lty = 1, lwd =2, pch = 19, col = 'gold1')
lines(type = 'b', Batting_Ohtani_100_la_year$year[Batting_Ohtani_100_la_year$pitch_type == 'FC'], Batting_Ohtani_100_la_year$launch_angle[Batting_Ohtani_100_la_year$pitch_type == 'FC'], lty = 1, lwd =2, pch = 19, col = 'limegreen')
lines(type = 'b', Batting_Ohtani_100_la_year$year[Batting_Ohtani_100_la_year$pitch_type == 'FF'], Batting_Ohtani_100_la_year$launch_angle[Batting_Ohtani_100_la_year$pitch_type == 'FF'], lty = 1, lwd =2, pch = 19, col = 'cyan4')
lines(type = 'b', Batting_Ohtani_100_la_year$year[Batting_Ohtani_100_la_year$pitch_type == 'FO'], Batting_Ohtani_100_la_year$launch_angle[Batting_Ohtani_100_la_year$pitch_type == 'FO'], lty = 1, lwd =2, pch = 19, col = 'darkorchid2')
lines(type = 'b', Batting_Ohtani_100_la_year$year[Batting_Ohtani_100_la_year$pitch_type == 'FS'], Batting_Ohtani_100_la_year$launch_angle[Batting_Ohtani_100_la_year$pitch_type == 'FS'], lty = 1, lwd =2, pch = 19, col = 'mediumorchid4')
lines(type = 'b', Batting_Ohtani_100_la_year$year[Batting_Ohtani_100_la_year$pitch_type == 'KC'], Batting_Ohtani_100_la_year$launch_angle[Batting_Ohtani_100_la_year$pitch_type == 'KC'], lty = 1, lwd =2, pch = 19, col = 'olivedrab4')
lines(type = 'b', Batting_Ohtani_100_la_year$year[Batting_Ohtani_100_la_year$pitch_type == 'SI'], Batting_Ohtani_100_la_year$launch_angle[Batting_Ohtani_100_la_year$pitch_type == 'SI'], lty = 1, lwd =2, pch = 19, col = 'seagreen')
lines(type = 'b', Batting_Ohtani_100_la_year$year[Batting_Ohtani_100_la_year$pitch_type == 'SL'], Batting_Ohtani_100_la_year$launch_angle[Batting_Ohtani_100_la_year$pitch_type == 'SL'], lty = 1, lwd =2, pch = 19, col = 'tomato')
legend("bottomright", c("CH (-3.1)", "CU (3.4)", "FA (NA)", "FC (-3.4)", "FF (+3.4)", "FO (NA)", "FS (+7.5)", "KC (-1.6)", "SI (-0.4)", "SL (-0.8)"), col = c("red", "orange", "gold1", "limegreen", "cyan4", "darkorchid", "mediumorchid4", "olivedrab4", "seagreen", "tomato"), lty = 1, lwd =2, text.col = c("blue", "black", "black", "blue", "black", "black", "black", "blue", "blue", "blue"), pch = 19)
###** Removing needless variables
remove(Batting_Ohtani_100_la_year, Batting_Ohtani_100_ls_year)
###*** 3.3 T test for exit velocity (launch speed) & launch angle----
###*** Defining variables:
###*** Batting_Split finger ball launch speed:
Launch_speed_FS_2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'FS' & Batting_Ohtani_100$year == '2022']
Launch_speed_FS_not2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'FS' & Batting_Ohtani_100$year != '2022']
###*** Batting_Changeup ball launch speed:
Launch_speed_CH_2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'CH' & Batting_Ohtani_100$year == '2022']
Launch_speed_CH_not2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'CH' & Batting_Ohtani_100$year != '2022']
###*** Batting_Curve ball launch speed:
Launch_speed_CU_2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'CU' & Batting_Ohtani_100$year == '2022']
Launch_speed_CU_not2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'CU' & Batting_Ohtani_100$year != '2022']
###*** Batting_changeup ball launch angle:
Launch_angle_CH_2022 <- Batting_Ohtani_100$launch_angle[Batting_Ohtani_100$pitch_type == 'CH' & Batting_Ohtani_100$year == '2022']
Launch_angle_CH_not2022 <- Batting_Ohtani_100$launch_angle[Batting_Ohtani_100$pitch_type == 'CH' & Batting_Ohtani_100$year != '2022']
###*** Batting_Cutter ball launch angle:
Launch_angle_FC_2022 <- Batting_Ohtani_100$launch_angle[Batting_Ohtani_100$pitch_type == 'FC' & Batting_Ohtani_100$year == '2022']
Launch_angle_FC_not2022 <- Batting_Ohtani_100$launch_angle[Batting_Ohtani_100$pitch_type == 'FC' & Batting_Ohtani_100$year != '2022']
###*** Checking T test of Ohtani's launch speed at Fast ball in 2022 and not in 2022
t.test(Launch_speed_FS_2022, Launch_speed_FS_not2022)
###*** Drawing density curve at Split finger ball
plot(density(Launch_speed_FS_not2022), main = "Ohtani's FS batting", xlab ='Speed(mph)', ylab = 'density', col = 'firebrick1', xlim = c(50,130), ylim = c(0,0.05), lty = 1, lwd = 2, cex.main = 1.5, cex.axis= 1.5, cex.lab= 1.5)
lines(density(Launch_speed_FS_2022), col = 'blue', lwd =2)
legend(60,0.05, c("not in 2022", "2022"), col = c('red', 'blue'), lwd = 2, cex= 1 )
###*** Checking T test of Ohtani's exit velocity at Curve ball in 2022 and not in 2022
t.test(Launch_speed_CU_2022, Launch_speed_CU_not2022)
###*** Drawing density curve at Curve ball
plot(density(Launch_speed_CU_not2022), main = "Ohtani's CU batting", xlab ='Speed(mph)', ylab = 'density', col = 'firebrick1', xlim = c(50,130), ylim = c(0,0.05), lty = 1, lwd = 2, cex.main = 1.5, cex.axis= 1.5, cex.lab= 1.5)
lines(density(Launch_speed_CU_2022), col = 'blue', lwd =2)
legend(60,0.05, c("not in 2022", "2022"), col = c('red', 'blue'), lwd = 2, cex= 1 )
###*** Checking T test of Ohtani's launch speed at changeup in 2022 and not in 2022
t.test(Launch_speed_CH_2022, Launch_speed_CH_not2022)
###*** Drawing density curve at Curve ball
plot(density(Launch_speed_CH_not2022), main = "Ohtani's CH batting", xlab ='Speed(mph)', ylab = 'density', col = 'firebrick1', xlim = c(50,130), ylim = c(0,0.08), lty = 1, lwd = 2, cex.main = 1.5, cex.axis= 1.5, cex.lab= 1.5)
lines(density(Launch_speed_CH_2022), col = 'blue', lwd =2)
legend(60,0.08, c("not in 2022", "2022"), col = c('red', 'blue'), lwd = 2, cex= 1 )
###*** Checking T test of Ohtani's launch angle at Changeup ball in 2022 and not in 2022
t.test(Launch_angle_CH_2022, Launch_angle_CH_not2022)
###*** Checking T test of Ohtani's launch angle at Cutter ball in 2022 and not in 2022
t.test(Launch_angle_FC_2022, Launch_angle_FC_not2022)
###*** Removing needless variables
remove(Launch_speed_FS_2022, Launch_speed_FS_not2022, Launch_speed_CH_2022, Launch_speed_CH_not2022, Launch_speed_CU_2022, Launch_speed_CU_not2022, Launch_angle_CH_2022, Launch_angle_CH_not202, Launch_angle_FC_2022, Launch_angle_FC_not2022 )
###*** Batting_Split finger ball launch speed:
Launch_speed_FS_2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'FS' & Batting_Ohtani_100$year == '2022']
Launch_speed_FS_not2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'FS' & Batting_Ohtani_100$year != '2022']
###*** Batting_Changeup ball launch speed:
Launch_speed_CH_2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'CH' & Batting_Ohtani_100$year == '2022']
Launch_speed_CH_not2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'CH' & Batting_Ohtani_100$year != '2022']
###*** Batting_Curve ball launch speed:
Launch_speed_CU_2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'CU' & Batting_Ohtani_100$year == '2022']
Launch_speed_CU_not2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'CU' & Batting_Ohtani_100$year != '2022']
###*** Batting_changeup ball launch angle:
Launch_angle_CH_2022 <- Batting_Ohtani_100$launch_angle[Batting_Ohtani_100$pitch_type == 'CH' & Batting_Ohtani_100$year == '2022']
Launch_angle_CH_not2022 <- Batting_Ohtani_100$launch_angle[Batting_Ohtani_100$pitch_type == 'CH' & Batting_Ohtani_100$year != '2022']
###*** Batting_Cutter ball launch angle:
Launch_angle_FC_2022 <- Batting_Ohtani_100$launch_angle[Batting_Ohtani_100$pitch_type == 'FC' & Batting_Ohtani_100$year == '2022']
Launch_angle_FC_not2022 <- Batting_Ohtani_100$launch_angle[Batting_Ohtani_100$pitch_type == 'FC' & Batting_Ohtani_100$year != '2022']
###*** Checking T test of Ohtani's launch speed at Fast ball in 2022 and not in 2022
t.test(Launch_speed_FS_2022, Launch_speed_FS_not2022)
###*** Drawing density curve at Split finger ball
plot(density(Launch_speed_FS_not2022), main = "Ohtani's FS batting", xlab ='Speed(mph)', ylab = 'density', col = 'firebrick1', xlim = c(50,130), ylim = c(0,0.05), lty = 1, lwd = 2, cex.main = 1.5, cex.axis= 1.5, cex.lab= 1.5)
lines(density(Launch_speed_FS_2022), col = 'blue', lwd =2)
legend(60,0.05, c("not in 2022", "2022"), col = c('red', 'blue'), lwd = 2, cex= 1 )
###*** Checking T test of Ohtani's exit velocity at Curve ball in 2022 and not in 2022
t.test(Launch_speed_CU_2022, Launch_speed_CU_not2022)
###*** Drawing density curve at Curve ball
plot(density(Launch_speed_CU_not2022), main = "Ohtani's CU batting", xlab ='Speed(mph)', ylab = 'density', col = 'firebrick1', xlim = c(50,130), ylim = c(0,0.05), lty = 1, lwd = 2, cex.main = 1.5, cex.axis= 1.5, cex.lab= 1.5)
lines(density(Launch_speed_CU_2022), col = 'blue', lwd =2)
legend(60,0.05, c("not in 2022", "2022"), col = c('red', 'blue'), lwd = 2, cex= 1 )
###*** Checking T test of Ohtani's launch speed at changeup in 2022 and not in 2022
t.test(Launch_speed_CH_2022, Launch_speed_CH_not2022)
###*** Drawing density curve at Curve ball
plot(density(Launch_speed_CH_not2022), main = "Ohtani's CH batting", xlab ='Speed(mph)', ylab = 'density', col = 'firebrick1', xlim = c(50,130), ylim = c(0,0.08), lty = 1, lwd = 2, cex.main = 1.5, cex.axis= 1.5, cex.lab= 1.5)
lines(density(Launch_speed_CH_2022), col = 'blue', lwd =2)
legend(60,0.08, c("not in 2022", "2022"), col = c('red', 'blue'), lwd = 2, cex= 1 )
###*** Checking T test of Ohtani's launch angle at Changeup ball in 2022 and not in 2022
t.test(Launch_angle_CH_2022, Launch_angle_CH_not2022)
###*** Checking T test of Ohtani's launch angle at Cutter ball in 2022 and not in 2022
t.test(Launch_angle_FC_2022, Launch_angle_FC_not2022)
###*** Removing needless variables
remove(Launch_speed_FS_2022, Launch_speed_FS_not2022, Launch_speed_CH_2022, Launch_speed_CH_not2022, Launch_speed_CU_2022, Launch_speed_CU_not2022, Launch_angle_CH_2022, Launch_angle_CH_not202, Launch_angle_FC_2022, Launch_angle_FC_not2022 )
View(Allplayers_Batting_AVG)
t.test(Launch_speed_FS_2022, Launch_speed_FS_not2022)
Launch_speed_FS_2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'FS' & Batting_Ohtani_100$year == '2022']
Launch_speed_FS_not2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'FS' & Batting_Ohtani_100$year != '2022']
###*** Batting_Changeup ball launch speed:
Launch_speed_CH_2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'CH' & Batting_Ohtani_100$year == '2022']
Launch_speed_CH_not2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'CH' & Batting_Ohtani_100$year != '2022']
###*** Batting_Curve ball launch speed:
Launch_speed_CU_2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'CU' & Batting_Ohtani_100$year == '2022']
Launch_speed_CU_not2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'CU' & Batting_Ohtani_100$year != '2022']
###*** Batting_changeup ball launch angle:
Launch_angle_CH_2022 <- Batting_Ohtani_100$launch_angle[Batting_Ohtani_100$pitch_type == 'CH' & Batting_Ohtani_100$year == '2022']
Launch_angle_CH_not2022 <- Batting_Ohtani_100$launch_angle[Batting_Ohtani_100$pitch_type == 'CH' & Batting_Ohtani_100$year != '2022']
###*** Batting_Cutter ball launch angle:
Launch_angle_FC_2022 <- Batting_Ohtani_100$launch_angle[Batting_Ohtani_100$pitch_type == 'FC' & Batting_Ohtani_100$year == '2022']
Launch_angle_FC_not2022 <- Batting_Ohtani_100$launch_angle[Batting_Ohtani_100$pitch_type == 'FC' & Batting_Ohtani_100$year != '2022']
###*** Removing needless variables
remove(Launch_speed_FS_2022, Launch_speed_FS_not2022, Launch_speed_CH_2022, Launch_speed_CH_not2022, Launch_speed_CU_2022, Launch_speed_CU_not2022, Launch_angle_CH_2022, Launch_angle_CH_not202, Launch_angle_FC_2022, Launch_angle_FC_not2022 )
###*** Batting_Split finger ball launch speed:
Launch_speed_FS_2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'FS' & Batting_Ohtani_100$year == '2022']
Launch_speed_FS_not2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'FS' & Batting_Ohtani_100$year != '2022']
###*** Batting_Changeup ball launch speed:
Launch_speed_CH_2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'CH' & Batting_Ohtani_100$year == '2022']
Launch_speed_CH_not2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'CH' & Batting_Ohtani_100$year != '2022']
###*** Batting_Curve ball launch speed:
Launch_speed_CU_2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'CU' & Batting_Ohtani_100$year == '2022']
Launch_speed_CU_not2022 <- Batting_Ohtani_100$launch_speed[Batting_Ohtani_100$pitch_type == 'CU' & Batting_Ohtani_100$year != '2022']
###*** Batting_changeup ball launch angle:
Launch_angle_CH_2022 <- Batting_Ohtani_100$launch_angle[Batting_Ohtani_100$pitch_type == 'CH' & Batting_Ohtani_100$year == '2022']
Launch_angle_CH_not2022 <- Batting_Ohtani_100$launch_angle[Batting_Ohtani_100$pitch_type == 'CH' & Batting_Ohtani_100$year != '2022']
###*** Batting_Cutter ball launch angle:
Launch_angle_FC_2022 <- Batting_Ohtani_100$launch_angle[Batting_Ohtani_100$pitch_type == 'FC' & Batting_Ohtani_100$year == '2022']
Launch_angle_FC_not2022 <- Batting_Ohtani_100$launch_angle[Batting_Ohtani_100$pitch_type == 'FC' & Batting_Ohtani_100$year != '2022']
###*** Removing needless variables
remove(Launch_speed_FS_2022, Launch_speed_FS_not2022, Launch_speed_CH_2022, Launch_speed_CH_not2022, Launch_speed_CU_2022, Launch_speed_CU_not2022, Launch_angle_CH_2022, Launch_angle_CH_not2022, Launch_angle_FC_2022, Launch_angle_FC_not2022 )
####* 4.1 Scatter plot ----
par(mfrow = c(2,2))
####* Plotting Pitchers' HR/FB
plot(Allplayers_Pitching_HRFB$year, Allplayers_Pitching_HRFB$HR.FB, type = 'b', lty = 1, lwd = 2, col = 'firebrick1', xlab = 'Year', ylim = c(7,16), ylab = '#', main = "MLB's HR/FB by different years", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
legend("bottomleft", c("Average launch speed"), lty = 3, lwd = 5, col = c('red'), pch = 19 )
####* Plotting Batters' AVG
plot(Allplayers_Batting_AVG$year, Allplayers_Batting_AVG$AVG, type = 'b', lty = 1, lwd = 2, col = 'firebrick1', xlab = 'Year', ylim = c(0.20,0.24), ylab = 'AVG(%)', main = "MLB's AVG by different years", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
legend("bottomleft", c("Average launch speed"), lty = 3, lwd = 5, col = c('red'), pch = 19 )
####* Plotting Batters' OBP
plot(Allplayers_Batting_OBP$year, Allplayers_Batting_OBP$OBP, type = 'b', lty = 1, lwd = 2, col = 'firebrick1', xlab = 'Year', ylim = c(0.265,0.31), ylab = 'OBP(%)', main = "MLB's OBP by different years", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
legend("bottomleft", c("Average launch speed"), lty = 3, lwd = 5, col = c('red'), pch = 19 )
####* Plotting Batters' SLG
plot(Allplayers_Batting_SLG$year, Allplayers_Batting_SLG$SLG, type = 'b', lty = 1, lwd = 2, col = 'firebrick1', xlab = 'Year', ylim = c(0.32,0.40), ylab = 'SLG(%)', main = "MLB's SLG by different years", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
legend("bottomleft", c("Average launch speed"), lty = 3, lwd = 5, col = c('red'), pch = 19 )
par(mfrow = c(1,1))
####* Removing the needless variables
remove(Allplayers_Pitching_HRFB, Allplayers_Batting_AVG, Allplayers_Batting_OBP, Allplayers_Batting_SLG)
#####* 5.1 Scatter plot ----
par(mfrow = c(2,2))
#####* Ohtani's by year AVG
plot(Allplayers_Pitching$year[Allplayers_Pitching$name == 'Shohei Ohtani'], Allplayers_Pitching$ERA[Allplayers_Pitching$name == "Shohei Ohtani"], ylim = c(2.5,3.5), type = 'b', lty = 1, lwd = 2, col = 'firebrick1', xlab = 'Year', ylab = 'ERA', main = "Ohtani by year's ERA", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
legend("bottomleft", c("Ohtani's by year AVG"), lty = 3, lwd = 5, col = c('red'), pch = 19 )
#####* Ohtani's by year K/9
plot(Allplayers_Pitching$year[Allplayers_Pitching$name == 'Shohei Ohtani'], Allplayers_Pitching$K.9[Allplayers_Pitching$name == "Shohei Ohtani"], ylim = c(10,15), type = 'b', lty = 1, lwd = 2, col = 'firebrick1', xlab = 'Year', ylab = 'K.9', main = "Ohtani by year's K.9", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
legend("topleft", c("Ohtani's by year AVG"), lty = 3, lwd = 5, col = c('red'), pch = 19 )
#####* Ohtani's by year BB/9
plot(Allplayers_Pitching$year[Allplayers_Pitching$name == 'Shohei Ohtani'], Allplayers_Pitching$BB.9[Allplayers_Pitching$name == "Shohei Ohtani"], ylim = c(1,4), type = 'b', lty = 1, lwd = 2, col = 'firebrick1', xlab = 'Year', ylab = 'BB.9', main = "Ohtani by year's BB.9", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
legend("bottomleft", c("Ohtani's by year AVG"), lty = 3, lwd = 5, col = c('red'), pch = 19 )
#####* Ohtani's by year AVG
plot(Allplayers_Pitching$year[Allplayers_Pitching$name == 'Shohei Ohtani'], Allplayers_Pitching$WAR[Allplayers_Pitching$name == "Shohei Ohtani"], type = 'b', lty = 1, lwd = 2, ylim = c(0,5), col = 'firebrick1', xlab = 'Year', ylab = 'WAR', main = "Ohtani by year's WAR", cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
legend("topleft", c("Ohtani's by year AVG"), lty = 3, lwd = 5, col = c('red'), pch = 19 )
par(mfrow = c(1,1))
###### 6.0 Clusters (Title only)
######* 6.1 Clusters
library(viridis)
par(mfrow = c(1,2))
(Pitching_Ohtani_pfx_cl <- kmeans(Pitching_Ohtani[,c("pfx_x","pfx_z")], 5))
plot(Pitching_Ohtani[,c("pfx_x","pfx_z")], col =Pitching_Ohtani_pfx_cl$cluster)
points(Pitching_Ohtani_pfx_cl$centers, col = viridis(5), pch = 19, cex = 2)
##* Ohtani's pfx_x V.S pfx_z
plot(type = 'p', Pitching_Ohtani$pfx_x[Pitching_Ohtani$pitch_type == 'CU'], Pitching_Ohtani$pfx_z[Pitching_Ohtani$pitch_type == 'CU'], lty = 3, lwd = 1, ylim = c(-2,2.5), xlim = c(-2,2.3), col = 'red', pch = 5, xlab ='pfx_x', ylab = 'pfx_z', main ='pfx_x V.S pfx_z', cex.axis= 1.5, cex.lab= 1.5, cex.main =1.5 )
lines(type = 'p', Pitching_Ohtani$pfx_x[Pitching_Ohtani$pitch_type == 'FC'], Pitching_Ohtani$pfx_z[Pitching_Ohtani$pitch_type == 'FC'], lty = 3, lwd = 1, col = 'orange', pch = 5)
lines(type = 'p', Pitching_Ohtani$pfx_x[Pitching_Ohtani$pitch_type == 'FF'], Pitching_Ohtani$pfx_z[Pitching_Ohtani$pitch_type == 'FF'], lty = 3, lwd = 1, col = 'gold1', pch = 5)
lines(type = 'p', Pitching_Ohtani$pfx_x[Pitching_Ohtani$pitch_type == 'FS'], Pitching_Ohtani$pfx_z[Pitching_Ohtani$pitch_type == 'FS'], lty = 3, lwd = 1, col = 'limegreen', pch = 5)
lines(type = 'p', Pitching_Ohtani$pfx_x[Pitching_Ohtani$pitch_type == 'SL'], Pitching_Ohtani$pfx_z[Pitching_Ohtani$pitch_type == 'SL'], lty = 3, lwd = 1, col = 'cyan4', pch = 5)
legend("bottomleft", c("Curve", "Cutter", "Fast", "Split-finger", "Slider"), col = c("red", "orange", "gold1", "limegreen", "cyan4"), lty = 3, lwd =1, pch = 5)
par(mfrow = c(1,1))
######* 6 Scatterplot 3D ----
######* Drawing a scatter 3D plot
library(scatterplot3d)
scatterplot3d(Pitching_Ohtani$vx0, Pitching_Ohtani$vy0, Pitching_Ohtani$vz0, highlight.3d = T, type = "p", lwd = 2, box = F, cex.axis = 0.5, main = "Ohtani's release speed = Vx0i + Vy0j + Vz0k")
######* Too much data, the result is not pretty clear
library(car)
library(rgl)
######* Checking another 3D function
scatter3d(Pitching_Ohtani$vx0, Pitching_Ohtani$vy0, Pitching_Ohtani$vz0, revolutions = 1)
######* It's still too complex, not a good indicator
#** Save data into a file with two sheets
library(openxlsx)
sheet <- list("launch_speed" = Batting_Ohtani_100_ls_tyear, "launch_speed_by_year_mean" = Batting_Ohtani_100_ls_checkyear_mean, "launch_speed_by_year_sd" = Batting_Ohtani_100_ls_checkyear_sd, "launch_angle" = Batting_Ohtani_100_la_tyear, "spin_rate" = Pitching_Ohtani_spinrate_table_year)
write.xlsx(sheet, file = "Save_Ohtani_batting.xlsx",  rowNames = F, overwrite = TRUE)
library(openxlsx)
install.packages("openxlsx")
